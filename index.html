<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Welcome to my Portfolio</title>

    <!-- linking stylesheet -->
    <link rel="stylesheet" href="./CSS/style.css" />
    <link rel="preload" href="images/background(1).webp" as="image" />
    <link rel="preload" href="images/mountain_1.webp" as="image" />
    <link rel="preload" href="images/mountain_6.webp" as="image" />
    <link rel="preload" href="images/mountain_5.webp" as="image" />
    <link rel="preload" href="images/mountain_8.png" as="image" />
    <link rel="preload" href="images/mountain_4.webp" as="image" />
  </head>
  <div class="preloader">
    <div class="counter">0</div>
  </div>
  <body>
    <main id="splash">
      <div class="vignette"></div>
      <img
        rel="preload"
        src="images/background(1).webp"
        data-rotation="0"
        data-speedx="0.3"
        data-speedy="0.38"
        data-speedz="0"
        data-rotation="0"
        data-distance="-200"
        class="parallax bg-img"
      />

      <img
        src="images/mountain_5.webp"
        data-rotation="0"
        data-speedx="0.195"
        data-speedy="0.305"
        data-speedz="0"
        data-rotation="0"
        data-distance="1100"
        class="parallax mountain-10"
      />

      <img
        src="images/mountain_6.webp"
        data-rotation="0.02"
        data-speedx="0.125"
        data-speedy="0.155"
        data-speedz="0.15"
        data-rotation="0.02"
        data-distance="1700"
        class="parallax mountain-9"
      />

      <img
        src="images/mountain_8.png"
        data-rotation="0.02"
        data-speedx="0.1"
        data-speedy="0.11"
        data-speedz="0"
        data-rotation="0.02"
        data-distance="1600"
        class="parallax mountain-8"
      />

      <img
        src="images/mountain_8.png"
        data-rotation="0.09"
        data-speedx="0.1"
        data-speedy="0.1"
        data-speedz="0"
        data-rotation="0.09"
        data-distance="1900"
        class="parallax mountain-7"
      />

      <div
        class="text parallax"
        sdata-rotation="0.11"
        data-speedx="0.07"
        data-speedy="0.07"
        data-rotation="0.11"
        data-speedz="0"
      >
        <h2>Jaskaran</h2>
        <br />
        <h1>Khosa</h1>
      </div>
      <img
        src="images/mountain_6.webp"
        data-rotation="0.12"
        data-speedx="0.065"
        data-speedy="0.05"
        data-speedz="0.05"
        data-rotation="0.12"
        data-distance="2300"
        class="parallax mountain-6"
      />

      <img
        src="images/mountain_5.webp"
        data-rotation="0.1"
        data-speedx="0.08"
        data-speedy="0.03"
        data-speedz="0.1"
        data-rotation="0.05"
        data-distance="2600"
        class="parallax mountain-5"
      />

      <img
        src="images/mountain_4.webp"
        data-rotation="0.14"
        data-speedx="0.059"
        data-speedy="0.024"
        data-speedz="0.35"
        data-rotation="0.04"
        data-distance="2800"
        class="parallax mountain-4"
      />

      <img
        src="images/mountain_1.webp"
        data-rotation="0.05"
        data-speedx="0.04"
        data-speedy="0.018"
        data-speedz="0.32"
        data-rotation="0.05"
        data-distance="3000"
        class="parallax mountain-3"
      />

      <img
        src="images/mountain_4.webp"
        data-rotation="0.15"
        data-speedx="0.0235"
        data-speedy="0.013"
        data-speedz="0.42"
        data-rotation="0.15"
        data-distance="3400"
        class="parallax mountain-2"
      />
      <img
        src="images/mountain_1.webp"
        data-rotation="0.2"
        data-speedx="0.027"
        data-speedy="0.018"
        data-speedz="0.53"
        data-rotation="0"
        data-distance="3800"
        class="parallax mountain-1"
      />

      <img
        src="images/fog_11.png"
        data-speedx="0.12"
        data-speedy="0.01"
        data-speedz="0"
        data-rotation="0.2"
        data-distance="4200"
        class="parallax fog-1"
      />
    </main>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

    <script type="text/javascript">
      function counter() {
        var count = setInterval(function () {
          var c = parseInt($(".counter").text());
          $(".counter").text((++c).toString());
          if (c == 100) {
            clearInterval(count);
            $(".counter").addClass("mide");
            $(".preloader").addClass("active");
          }
        }, 50);
      }
      preloadImages();
      counter();

      // Preload all images
      function preloadImages() {
        function redirectToMainPage() {
          var destination = "portfolio.html";
          $("body").fadeOut(1000, function () {
            window.location.replace(destination);
          });
        }

        // setTimeout(redirectToMainPage, 11000);

        function isMobileDevice() {
          return window.matchMedia("(max-width: 768px)").matches;
        }

        // Call setTimeout only if on a mobile device
        if (isMobileDevice()) {
          setTimeout(redirectToMainPage, 11000);
        }

        window.addEventListener("click", function () {
          var destination = "portfolio.html";
          $("body").fadeOut(1000, function () {
            window.location.replace(destination);
          });
        });
      }

      // creating inline css to decrease the requests
    </script>
    <script>
      const parallax_el = document.querySelectorAll(".parallax");
      const main = document.querySelector("main");

      let xValue = 0,
        yValue = 0;

      let rotateDegree = -0;
      parallax_el.forEach((el) => {
        el.style.transition = "0.45s cubic-bezier(0.2, 0.49, 0.32, 0.99)";
        el.style.willChange = "transform";
      });

      function update(cursorPosition) {}
      update(0);
      // Debounce function before your event listener
      function debounce(func, delay) {
        let inDebounce;
        return function () {
          const context = this;
          const args = arguments;
          cancelAnimationFrame(inDebounce);
          inDebounce = requestAnimationFrame(() => func.apply(context, args));
        };
      }

      window.addEventListener(
        "mousemove",
        debounce((e) => {
          // Your existing mousemove code here
          if (timeline.isActive()) return;
          xValue = e.clientX - window.innerWidth / 2;
          yValue = e.clientY - window.innerHeight / 2;
          rotateDegree = (xValue / (window, innerWidth / 2)) * 20;
          parallax_el.forEach((el) => {
            let speedx = el.dataset.speedx;
            let speedy = el.dataset.speedy;
            let speedz = el.dataset.speedz;
            let rotateSpeed = el.dataset.rotation;
            let isInLeft =
              parseFloat(getComputedStyle(el).left) < window.innerWidth / 2
                ? 1
                : -1;
            let zValue =
              (e.clientX - parseFloat(getComputedStyle(el).left)) *
              isInLeft *
              0.1;

            el.style.transform = `perspective(2300px) translateZ(${
              zValue * speedz
            }px) rotateY(${
              rotateDegree * rotateSpeed
            }deg) translateX(calc(-50% + ${
              -xValue * speedx
            }px))  translateY(calc(-50% + ${yValue * speedy}px))`;
            update(e.clientX);
          });
        }, 60)
      ); // 60 FPS, adjust as needed

      if (window.innerWidth >= 725) {
        main.style.maxHeight = `${window.innerWidth * 0.6}px`;
      } else {
        main.style.maxHeight = `${window.innerWidth * 1.6}px`;
      }

      let timeline = gsap.timeline();

      timeline
        .from(
          ".text h1",
          {
            y:
              window.innerHeight -
              document.querySelector(".text h1").getBoundingClientRect().top +
              200,
            duration: 2.5,
          },
          "3.5"
        )
        .from(
          ".text h2",
          {
            y: -150,
            opacity: 0,
            duration: 1.5,
          },
          "3.5"
        )
        .from(
          ".hide",
          {
            opacity: 0,
            duration: 1.5,
          },
          "3.5"
        );
    </script>

    <script>
      window.addEventListener("load", function () {
        const imagesToPreload = [
          "images/about12.webp",
          "images/about2.webp",
          "images/about3.webp",
          
        ];

        imagesToPreload.forEach((src) => {
          const img = new Image();
          img.src = src;
        });
      });
    </script>
  </body>
</html>
